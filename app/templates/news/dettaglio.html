{% extends "base.html" %}
{% block title %}{{ disco.titolo }}{% endblock %}
{% block content %}
<div class="d-flex justify-between align-center mb-3">
    <h1 style="font-size: 2rem; font-weight: 700;">{{ disco.titolo }}</h1>
    <div class="d-flex gap-1">
        {% if current_user.is_editor() or disco.creato_da == current_user.id %}
        <a href="{{ url_for('dischi.modifica', id=disco.id) }}" class="btn btn-warning"><i class="fas fa-edit"></i> Modifica</a>
        {% if current_user.is_editor() %}<a href="{{ url_for('dischi.elimina', id=disco.id) }}" class="btn btn-danger"><i class="fas fa-trash"></i> Elimina</a>{% endif %}
        {% endif %}
        <a href="{{ url_for('dischi.lista') }}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Indietro</a>
    </div>
</div>
<div class="grid grid-3">
    <div class="card">
        {% if disco.copertina %}
        <img src="{{ url_for('static', filename='uploads/images/' + disco.copertina) }}" style="width: 100%; border-radius: 12px; margin-bottom: 1rem;">
        {% else %}
        <div style="width: 100%; height: 300px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;"><i class="fas fa-compact-disc" style="font-size: 6rem; color: white;"></i></div>
        {% endif %}
        <p><strong>Formato:</strong> {{ disco.formato }}</p>
        <p><strong>Data Uscita:</strong> {{ disco.data_uscita.strftime('%d/%m/%Y') if disco.data_uscita else 'N/A' }}</p>
        <p><strong>Etichetta:</strong> {{ disco.etichetta }}</p>
        <p><strong>Tracce:</strong> {{ disco.numero_tracce or 'N/A' }}</p>
        <div style="margin-top: 1rem;">
            {% if disco.link_spotify %}<a href="{{ disco.link_spotify }}" target="_blank" class="btn btn-sm btn-success"><i class="fab fa-spotify"></i></a>{% endif %}
            {% if disco.link_apple_music %}<a href="{{ disco.link_apple_music }}" target="_blank" class="btn btn-sm btn-danger"><i class="fab fa-apple"></i></a>{% endif %}
            {% if disco.link_youtube %}<a href="{{ disco.link_youtube }}" target="_blank" class="btn btn-sm btn-danger"><i class="fab fa-youtube"></i></a>{% endif %}
        </div>
    </div>
    <div style="grid-column: span 2;">
        <div class="card">
            <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">Descrizione</h2>
            <p>{{ disco.descrizione or 'Nessuna descrizione disponibile.' }}</p>
        </div>
        <div class="card">
            <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">Artisti</h2>
            {% if disco.artisti %}
            <div class="item-list">
                {% for artista in disco.artisti %}
                <div class="item-card">
                    {% if artista.foto %}
                    <img src="{{ url_for('static', filename='uploads/images/' + artista.foto) }}" class="item-image">
                    {% else %}
                    <div class="item-image" style="background: linear-gradient(135deg, #6366f1, #8b5cf6); display: flex; align-items: center; justify-content: center;"><i class="fas fa-user-music" style="font-size: 2rem; color: white;"></i></div>
                    {% endif %}
                    <div class="item-details">
                        <div class="item-title">{{ artista.nome_arte }}</div>
                        <div class="item-meta">{{ artista.genere_musicale }}</div>
                    </div>
                    <a href="{{ url_for('artisti.dettaglio', id=artista.id) }}" class="btn btn-sm btn-primary"><i class="fas fa-eye"></i></a>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p style="color: #64748b;">Nessun artista associato</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
