{% extends "base.html" %}

{% block title %}Dashboard - Maqueta{% endblock %}

{% block content %}
<div class="d-flex justify-between align-center mb-3">
    <h1 style="font-size: 2rem; font-weight: 700;">Dashboard</h1>
    <div>
        <span style="color: #64748b;">Benvenuto, <strong>{{ current_user.username }}</strong></span>
    </div>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon primary">
            <i class="fas fa-user-music"></i>
        </div>
        <div class="stat-details">
            <h3>{{ stats.artisti }}</h3>
            <p>Artisti</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon success">
            <i class="fas fa-compact-disc"></i>
        </div>
        <div class="stat-details">
            <h3>{{ stats.dischi }}</h3>
            <p>Dischi</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon warning">
            <i class="fas fa-music"></i>
        </div>
        <div class="stat-details">
            <h3>{{ stats.singoli }}</h3>
            <p>Singoli</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon info">
            <i class="fas fa-calendar-alt"></i>
        </div>
        <div class="stat-details">
            <h3>{{ stats.eventi }}</h3>
            <p>Eventi</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon secondary">
            <i class="fas fa-file-alt"></i>
        </div>
        <div class="stat-details">
            <h3>{{ stats.documenti }}</h3>
            <p>Documenti</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon danger">
            <i class="fas fa-newspaper"></i>
        </div>
        <div class="stat-details">
            <h3>{{ stats.news }}</h3>
            <p>News Pubblicate</p>
        </div>
    </div>
</div>

<!-- Quick Actions -->
{% if current_user.is_editor() %}
<div class="card">
    <div class="card-header">
        <h2 class="card-title">Azioni Rapide</h2>
    </div>
    <div class="d-flex gap-2" style="flex-wrap: wrap;">
        <a href="{{ url_for('artisti.nuovo') }}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Nuovo Artista
        </a>
        <a href="{{ url_for('dischi.nuovo') }}" class="btn btn-success">
            <i class="fas fa-plus"></i> Nuovo Disco
        </a>
        <a href="{{ url_for('singoli.nuovo') }}" class="btn btn-warning">
            <i class="fas fa-plus"></i> Nuovo Singolo
        </a>
        <a href="{{ url_for('eventi.nuovo') }}" class="btn btn-secondary">
            <i class="fas fa-plus"></i> Nuovo Evento
        </a>
        <a href="{{ url_for('news.nuova') }}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Nuova News
        </a>
    </div>
</div>
{% endif %}

<!-- Recent Content -->
<div class="grid grid-2">
    <!-- Ultimi Artisti -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Ultimi Artisti</h2>
            <a href="{{ url_for('artisti.lista') }}" class="btn btn-sm btn-outline">Vedi tutti</a>
        </div>
        <div class="item-list">
            {% for artista in ultimi_artisti %}
            <div class="item-card">
                {% if artista.foto %}
                <img src="{{ url_for('static', filename='uploads/images/' + artista.foto) }}" alt="{{ artista.nome_arte }}" class="item-image">
                {% else %}
                <div class="item-image" style="display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                    <i class="fas fa-user-music" style="font-size: 2rem; color: white;"></i>
                </div>
                {% endif %}
                <div class="item-details">
                    <div class="item-title">{{ artista.nome_arte }}</div>
                    <div class="item-meta">{{ artista.genere_musicale or 'Non specificato' }}</div>
                    <div class="item-meta" style="font-size: 0.75rem; margin-top: 0.25rem;">
                        <i class="fas fa-clock"></i> {{ artista.data_creazione.strftime('%d/%m/%Y') }}
                    </div>
                </div>
                <div class="item-actions">
                    <a href="{{ url_for('artisti.dettaglio', id=artista.id) }}" class="btn btn-sm btn-primary">
                        <i class="fas fa-eye"></i>
                    </a>
                </div>
            </div>
            {% else %}
            <p style="text-align: center; color: #64748b; padding: 2rem;">Nessun artista ancora</p>
            {% endfor %}
        </div>
    </div>

    <!-- Ultimi Dischi -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Ultimi Dischi</h2>
            <a href="{{ url_for('dischi.lista') }}" class="btn btn-sm btn-outline">Vedi tutti</a>
        </div>
        <div class="item-list">
            {% for disco in ultimi_dischi %}
            <div class="item-card">
                {% if disco.copertina %}
                <img src="{{ url_for('static', filename='uploads/images/' + disco.copertina) }}" alt="{{ disco.titolo }}" class="item-image">
                {% else %}
                <div class="item-image" style="display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #10b981, #059669);">
                    <i class="fas fa-compact-disc" style="font-size: 2rem; color: white;"></i>
                </div>
                {% endif %}
                <div class="item-details">
                    <div class="item-title">{{ disco.titolo }}</div>
                    <div class="item-meta">{{ disco.formato or 'Non specificato' }}</div>
                    <div class="item-meta" style="font-size: 0.75rem; margin-top: 0.25rem;">
                        <i class="fas fa-clock"></i> {{ disco.data_creazione.strftime('%d/%m/%Y') }}
                    </div>
                </div>
                <div class="item-actions">
                    <a href="{{ url_for('dischi.dettaglio', id=disco.id) }}" class="btn btn-sm btn-success">
                        <i class="fas fa-eye"></i>
                    </a>
                </div>
            </div>
            {% else %}
            <p style="text-align: center; color: #64748b; padding: 2rem;">Nessun disco ancora</p>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Prossimi Eventi -->
{% if prossimi_eventi %}
<div class="card">
    <div class="card-header">
        <h2 class="card-title">Prossimi Eventi</h2>
        <a href="{{ url_for('eventi.lista') }}" class="btn btn-sm btn-outline">Vedi tutti</a>
    </div>
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Titolo</th>
                    <th>Tipo</th>
                    <th>Data</th>
                    <th>Luogo</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody>
                {% for evento in prossimi_eventi %}
                <tr>
                    <td><strong>{{ evento.titolo }}</strong></td>
                    <td><span class="badge badge-info">{{ evento.tipo }}</span></td>
                    <td>{{ evento.data_inizio.strftime('%d/%m/%Y %H:%M') }}</td>
                    <td>{{ evento.luogo or 'Non specificato' }}</td>
                    <td>
                        <a href="{{ url_for('eventi.dettaglio', id=evento.id) }}" class="btn btn-sm btn-primary">
                            <i class="fas fa-eye"></i>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endif %}
{% endblock %}
