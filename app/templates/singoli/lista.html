{% extends "base.html" %}
{% from "_macros.html" import render_pagination %}
{% block title %}Singoli{% endblock %}
{% block content %}
<div class="d-flex justify-between align-center mb-3">
    <h1 style="font-size: 2rem; font-weight: 700;">Singoli</h1>
    {% if current_user.is_editor() %}<a href="{{ url_for('singoli.nuovo') }}" class="btn btn-warning"><i class="fas fa-plus"></i> Nuovo Singolo</a>{% endif %}
</div>
<div class="grid grid-3">
    {% for singolo in singoli.items %}
    <div class="card" style="padding: 0; overflow: hidden;">
        {% if singolo.copertina %}
        <img src="{{ url_for('static', filename='uploads/images/' + singolo.copertina) }}" style="width: 100%; height: 200px; object-fit: cover;">
        {% else %}
        <div style="width: 100%; height: 200px; background: linear-gradient(135deg, #f59e0b, #d97706); display: flex; align-items: center; justify-content: center;"><i class="fas fa-music" style="font-size: 4rem; color: white;"></i></div>
        {% endif %}
        <div style="padding: 1.5rem;">
            <h3 style="margin-bottom: 0.5rem;">{{ singolo.titolo }}</h3>
            <p style="color: #64748b; font-size: 0.875rem; margin-bottom: 1rem;">{{ singolo.durata or 'N/A' }}</p>
            <div class="d-flex gap-1">
                <a href="{{ url_for('singoli.dettaglio', id=singolo.id) }}" class="btn btn-sm btn-warning"><i class="fas fa-eye"></i></a>
                {% if current_user.is_editor() or singolo.creato_da == current_user.id %}
                <a href="{{ url_for('singoli.modifica', id=singolo.id) }}" class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></a>
                {% if current_user.is_editor() %}<a href="{{ url_for('singoli.elimina', id=singolo.id) }}" class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></a>{% endif %}
                {% endif %}
            </div>
        </div>
    </div>
    {% else %}
    <div class="card" style="grid-column: 1/-1; text-align: center; padding: 3rem;"><p style="color: #64748b;">Nessun singolo trovato</p></div>
    {% endfor %}
</div>
{{ render_pagination(singoli, 'singoli.lista') }}
{% endblock %}
